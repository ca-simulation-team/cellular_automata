<div id="controlPanel" class="panel panel-default col-md-3">
    <div class="panel-body">
        <div id="controlButtons" class="btn-group btn-group-sm" style="margin: 0 auto">
            <button class="btn btn-default" id="playBtn" ng-click="controlSim('playing')" ng-disabled="!playEnabled">
                <img src="resources/images/icons/appbar.control.play.png" class="button_icon">
            </button>
            <button class="btn btn-default" id="pauseBtn" ng-click="controlSim('paused')" ng-disabled="!pauseEnabled">
                <img src="resources/images/icons/appbar.control.pause.png" class="button_icon">
            </button>
            <button class="btn btn-default" id="stopBtn"  ng-click="controlSim('stopped')" ng-disabled="!stopEnabled">
                <img src="resources/images/icons/appbar.control.stop.png" class="button_icon">
            </button>
            <button class="btn btn-default" id="resumeBtn" ng-click="controlSim('stepped')" ng-disabled="!stepEnabled">
                <img src="resources/images/icons/appbar.control.resume.png" class="button_icon">
            </button>
        </div> <!--button group end -->

        <hr/>
        <ul class="nav nav-tabs" role="tablist" id="myTab">
            <li class="active"><a href="#model" role="tab" data-toggle="tab">Model</a></li>
            <li><a href="#parameters" role="tab" data-toggle="tab">Parameters</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="model">
                <div ng-show="!simLoaded">
                    <div class="sidemenuitem">
                        <button class="btn btn-default" type="button" ng-click="createNewSim()">Create New CA Simulation</button>
                    </div>
                    
                </div>
                <div ng-show="simLoaded">
                    <div class="sidemenuitem">
                        <span>Grid Size:</span><input type="number" class="form-control" min="2" max="70" ng-model="simObject.gridSize" ng-blur="updateGridSize()"/>
                        <span>Cell Size:</span><input type="number" class="form-control" min="5" max="100" ng-model="simObject.cellSize" ng-blur="drawFromCurrent()"/>
                        
                    </div>
                    <div class="sidemenuitem">
                        <span>States</span><br/>
                        <button type="button" class="btn btn-default" data-toggle="collapse" data-target="#createState">Create New State</button>
                        <div id="createState" class="collapse">
                            <input type="text" class="form-control" placeholder="State Name" ng-model="stateName" style="margin-top: 10px" ng-required/>
                            <span>Color: </span><input type="color" class="form-control" ng-model="stateColor" style="margin-top: 10px; width: 120px; display: inline"/>
                            <button type="button" class="btn btn-default" ng-click="addState()" style="margin-top: 10px; float: right">Add</button>
                        </div>
                        <div class="radio" ng-repeat="state in simObject.states">
                            <label>
                                <input type="radio" name="states" id="states" ng-model="$parent.stateSelected" ng-value="state"/>
                                {{state.stateIndex}} - {{state.stateName}} 
                            </label>
                        </div>
                    </div>
                    <div class="sidemenuitem_bottom">
                        <span>Rules</span><br/>
                        <button type="button" class="btn btn-default" data-toggle="collapse" data-target="#createRule">Create New Rule</button>
                        <div id="createRule" class="collapse">
                            <input type="checkbox" name="checkDynamic" ng-model="isDynamic" checked="checked"/>Dynamic Rule <br/>
                            <div ng-show="isDynamic">
                                <span>If cell state is: </span>
                            <select class="form-control" ng-model="ruleCurrentState" ng-options="state.stateIndex for state in simObject.states" style="display: inline; width: 70px"></select>
                            <br/><span>and the state of the neighbors are:</span>
                            <select class="form-control" ng-model="ruleNeighborState" ng-options="state.stateIndex for state in simObject.states" style="display: inline; width: 70px"></select>
                            <br/><span>and the number of neighbors the cell has is:</span>
                            <select class="form-control" ng-model="ruleEqualityModifier" style="display: inline; width: 120px">
                               <option ng-value="0">Equal to</option>
                               <option ng-value="1">Less than</option>
                               <option ng-value="2">Greater than</option>
                            </select>
                           <select class="form-control" ng-model="ruleNeighborCount" ng-options="possible for possible in possibleNeighbors" style="display: inline; width: 70px"></select>
                            </div>
                            <div ng-show="!isDynamic">
                                <span>Draw static rule pattern:</span>
                                <canvas id="staticRuleDraw" width="40" height="40" style="display: inline-block"></canvas>
                            </div>
                            <br/><span>The next state of cell must be:</span>
                            <select class="form-control" ng-model="ruleNextState" ng-options="state.stateIndex for state in simObject.states" style="display: inline; width: 70px"></select>
                            <br/><hr/><span>Set probability (% from 0 to 100) :</span>
                            <input type="number" class="form-control" ng-model="ruleProbability" min="0" max="100"/>
                            <button type="button" class="btn btn-default" ng-click="addRule()" style="margin-top: 10px">Add</button>
                        </div>
                        <div style="margin-top: 10px;">
                            <div ng-repeat="rule in simObject.rules" style="margin-top: 5px">
                                <button type="button" class="btn btn-default" ng-click="setSelectedRule($index)">
                                    <img src="resources/images/icons/currentCell.png" class="button_icon" style="display: inline"/>
                                    <span>{{rule.currentState}} | </span>
                                    <img src="resources/images/icons/nebState.png" class="button_icon" style="display: inline"/>
                                    <span>{{rule.neighborState}} | </span>
                                    <img src="resources/images/icons/appbar.box.unfolded.png" class="button_icon" style="display: inline"/>
                                    <span>{{rule.noOfNeighbors}} | </span>
                                    <img src="resources/images/icons/appbar.markup.png" class="button_icon" style="display: inline"/>
                                    <span>{{rule.equalityModifier}} | </span>
                                    <img src="resources/images/icons/next_state.png" class="button_icon" style="display: inline"/>
                                    <span>{{rule.nextState}} |</span>
                                    <img src="resources/images/icons/dice.png" class="button_icon" style="display: inline"/>
                                    <span>{{rule.probability}}</span>
                                </button>
                                
                                <div class="panel panel-default" ng-show="!rule.collapsed">
                                    <div class="panel-body">
                                        
                                        <span>If cell state is: </span>
                                        <select class="form-control" ng-model="rule.currentState" ng-options="state.stateIndex as state.stateIndex for state in simObject.states" style="display: inline; width: 70px" ng-change="$parent.rulesChanged = true"></select>
                                        <br/><span>and the state of the neighbors are:</span>
                                        <select class="form-control" ng-model="rule.neighborState" ng-options="state.stateIndex as state.stateIndex for state in simObject.states" style="display: inline; width: 70px" ng-change="$parent.rulesChanged = true"></select>
                                        <br/><span>and the number of neighbors the cell has is:</span>
                                        <select class="form-control" ng-model="rule.equalityModifier" style="display: inline; width: 120px" ng-change="$parent.rulesChanged = true">
                                           <option ng-value="0">Equal to</option>
                                           <option ng-value="1">Less than</option>
                                           <option ng-value="2">Greater than</option>
                                        </select>
                                       <select class="form-control" ng-model="rule.noOfNeighbors" ng-options="possible as possible for possible in possibleNeighbors" style="display: inline; width: 70px" ng-change="$parent.rulesChanged = true"></select>
                                        <br/><span>The state of cell must change into</span>
                                        <select class="form-control" ng-model="rule.nextState" ng-options="state.stateIndex as state.stateIndex for state in simObject.states" style="display: inline; width: 70px" ng-change="$parent.rulesChanged = true"></select>
                                        <br/><hr/><span>Set probability (% from 0 to 100) :</span>
                                        <input type="number" class="form-control" ng-model="rule.probability" min="0" max="100" ng-change="$parent.rulesChanged = true"/>
                                        <button type="button" class="btn btn-default" ng-click="removeRule($index)" style="margin-top: 10px">Remove</button>

                                    </div>
                                </div>
                            </div>
                        </div> 
                    </div>
                </div>
            </div>
            <div class="tab-pane" id="parameters">
                <div class="sidemenuitem_bottom">
                    <span>Set delay:</span><br/>
                    <input id="speedAdjuster" type="range" min="0" max="1000" value="0" step="0.1" ng-model="delay"/>
                    <span>Delay(ms): {{delay}}</span>
                </div>
                
            </div>
        </div>
    </div> <!--main panel body end -->
</div> <!--main panel end -->
<div class="col-md-9">
    <div class="panel panel-default">
        <div class="panel-body">
            <div ng-repeat="state in simObject.states" style="display: inline">
                <button ng-class="{'btn btn-default' : true, 'active' : state.stateIndex == $parent.stateSelected.stateIndex}" ng-click="$parent.setStateSelected(state.stateIndex, state.stateName, state.stateColor)" ng-style="{'border' : '2px solid {{state.stateColor}}'}">
                    {{state.stateName}}
                </button>
            </div>
        </div>
    </div>
    <canvas id="drawArea" width="420" height="420" style="display: block"></canvas>
    <canvas id="drawNeighbourhood" width="200" height="200" style="display: none"></canvas>
    <Button id="neighbourhoodButton" style="display: none" onclick="createdNeighbourhood()"> create neighbourhood </Button>
    
</div>
<!--<div class="panel panel-default col-md-3">
    <span>Analytics</span>
    <button class="btn btn-default" ng-click="createDataForPieChart()">Draw pie chart</button>
    <canvas id="myChart" width="200" height="200"></canvas>
</div>-->